<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Resolver DNSSEC Response Serialization</title>
<meta content="Sudheesh Singanamalla" name="author">
<meta content="Ben Weintraub" name="author">
<meta content="Thibault Meunier" name="author">
<meta content="
       This document introduces a DNSSEC serialization format. It is designed to enable recursive resolvers to provide
the complete DNSSEC validation chain to DNS clients in one request over any transport. It is one mechanism to share
a specific view of the DNS ecosystem and to ensure authenticity without imposing recursive resolution on clients. 
    " name="description">
<meta content="xml2rfc 3.18.2" name="generator">
<meta content="next generation" name="keyword">
<meta content="unicorn" name="keyword">
<meta content="sparkling distributed ledger" name="keyword">
<meta content="draft-singanamalla-dance-dnssec-serialization-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.18.2
    Python 3.11.6
    ConfigArgParse 1.5.3
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 4.0.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.31.0
    setuptools 67.7.2
    six 1.16.0
    wcwidth 0.2.10
-->
<link href="draft-singanamalla-dance-dnssec-serialization.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Resolver DNSSEC Response Serialization</td>
<td class="right">November 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Singanamalla, et al.</td>
<td class="center">Expires 23 May 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">WG Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-singanamalla-dance-dnssec-serialization-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-11-20" class="published">20 November 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-05-23">23 May 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Singanamalla</div>
<div class="org">University of Washington</div>
</div>
<div class="author">
      <div class="author-name">B. Weintraub</div>
<div class="org">Northeastern University</div>
</div>
<div class="author">
      <div class="author-name">T. Meunier</div>
<div class="org">Cloudflare</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Resolver DNSSEC Response Serialization</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document introduces a DNSSEC serialization format. It is designed to enable recursive resolvers to provide
the complete DNSSEC validation chain to DNS clients in one request over any transport. It is one mechanism to share
a specific view of the DNS ecosystem and to ensure authenticity without imposing recursive resolution on clients.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://example.com/LATEST">https://example.com/LATEST</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-singanamalla-dance-dnssec-serialization/">https://datatracker.ietf.org/doc/draft-singanamalla-dance-dnssec-serialization/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        WG Working Group mailing list (<span><a href="mailto:WG@example.com">mailto:WG@example.com</a></span>),
        which is archived at <span><a href="https://example.com/WG">https://example.com/WG</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/USER/REPO">https://github.com/USER/REPO</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 23 May 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-dnssec-serialization" class="internal xref">DNSSEC Serialization</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-construction-using-a-recurs" class="internal xref">Construction using a Recursive Resolver</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-client" class="internal xref">Client</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-resolver-verification" class="internal xref">Resolver Verification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-client-verification" class="internal xref">Client Verification</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-resolver-cache-consideratio" class="internal xref">Resolver Cache Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-modifications-to-existing-r" class="internal xref">Modifications to Existing RFCs</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-performance-considerations" class="internal xref">Performance Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-size-overheads" class="internal xref">Size Overheads</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-measured-latency-overheads" class="internal xref">Measured Latency Overheads</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#appendix-A.1" class="auto internal xref"></a><a href="#name-test-vectors" class="internal xref">Test Vectors</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-appendix" class="internal xref">Appendix</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#appendix-B.1" class="auto internal xref"></a><a href="#name-test-vectors-2" class="internal xref">Test vectors</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document describes a use of the DNS additional record section to transit a serialized DNSSEC proof, and
introduces a new DNS Flag bit (SP)
to be used, in addition to DNSSEC OK (DO), to indicate the client's intent to obtain a serialized proof of
all RRs necessary to validate the DNSSEC chain.
A recursive resolver performs the necessary queries and
obtains the responses before responding to the client query with a direct answer. The serialization
mechanism with the complete DNSSEC verification chain enables resolvers to
share their view of the DNS ecosystem. Additionally, the transport agnostic nature allows future
DNS protocols, and applications relying on DNS infrastructure as a trust anchor to be interoperable allowing a higher
focus on the transport layer innovations than addressing DNS interoperability.<a href="#section-1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dnssec-serialization">
<section id="section-3">
      <h2 id="name-dnssec-serialization">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-dnssec-serialization" class="section-name selfRef">DNSSEC Serialization</a>
      </h2>
<div id="construction-using-a-recursive-resolver">
<section id="section-3.1">
        <h3 id="name-construction-using-a-recurs">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-construction-using-a-recurs" class="section-name selfRef">Construction using a Recursive Resolver</a>
        </h3>
<p id="section-3.1-1">A DNSSEC validating recursive resolver <span class="bcp14">MAY</span> accept DNS queries <span><a href="https://rfc-editor.org/rfc/rfc1034#section-2.4" class="relref">Section 2.4</a> of [<a href="#RFC1034" class="cite xref">RFC1034</a>]</span> with the SP bit set.
To process a client DNS query with SP bit set, a resolver <span class="bcp14">MUST</span> initialize an authenticated connection to
the respective name servers in the resolution process, and construct the following data structures.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The following structures comprise a single resource yet, but are also designed hold well-formed resource records within them in a nested structure.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">Each resource record contains an <code>RR_Header</code> structure.
The <code>RR_Header</code> structure is a resource record header <span class="contact-name">{Section 3.2.1 of RFC1035</span>}, which we keep in place, to maintain backwards compatibility with clients and libraries who are expecting well-formed resource records. The structure of <code>RR_Header</code> is the following.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-4">
<pre>
type RR_Header struct {
        Name     string
        Rrtype   uint16
        Class    uint16
        Ttl      uint32
        Rdlength uint16
}
</pre><a href="#section-3.1-4" class="pilcrow">¶</a>
</div>
<p id="section-3.1-5"><code>RR_Header</code> <span class="bcp14">MAY</span> contain values in any of the fields, but does not need to. These are not used in verification, but could be used for debugging.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">The core structure of this DNSSEC chain serialization protocol is the <code>Zone</code> structure. It <span class="bcp14">MUST</span> contain the domain name of the DNS zone in <code>Name</code>, the zone name of the previously traversed zone in <code>PreviousName</code>, and the index of the zone signing key (ZSK) used to sign the enclosed records <code>ZSKIndex</code>. The remaining fields are either lists of resource records of a particular type, or an 8-bit unsigned integer representing the number of records in each list. The resource records contained in lists include <code>DNSKEY</code>, <code>RRSIG DNSKEY</code>, <code>DS</code>, and <code>RRSIG DS</code>. The <code>Leaves</code> list contains resource records that are unknown until they are received. Their type depends on the DNS configuration---the types of resource records in <code>Leaves</code> <span class="bcp14">MAY</span> be any resource record type not already listed. The final field, <code>LeavesSigs</code>, contains the list of <code>RRSIG</code>s of the resource records in <code>Leaves</code>. The <code>DS</code>, <code>DNSKEY</code>, <code>RRSIG</code>, and leaf records all <span class="bcp14">MUST</span> follow the uncompressed wire format DNS RRs described in <span>[<a href="#DNSSEC" class="cite xref">DNSSEC</a>]</span> and <span>[<a href="#RDATA" class="cite xref">RDATA</a>]</span>.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-7">
<pre>
type Zone struct {
        Hdr           RR_Header
        Name          Name
        PreviousName  Name
        ZSKIndex      uint8
        NumKeys       uint8
        Keys          []DNSKEY
        NumKeySigs    uint8
        KeySigs       []RRSIG
        NumDS         uint8
        DSSet         []DS
        NumDSSigs     uint8
        DSSigs        []RRSIG
        NumLeaves     uint8
        Leaves        []RR
        NumLeavesSigs uint8
        LeavesSigs    []RRSIG
}
</pre><a href="#section-3.1-7" class="pilcrow">¶</a>
</div>
<p id="section-3.1-8">These zones are listed the topmost data structure called <code>Chain</code> (see below). In <code>Chain</code>, the field <code>NumZones</code> stores the number of <code>Zone</code>s in <code>Zones</code>. These <code>Zones</code> are traversed during verification.<a href="#section-3.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-9">
<pre>
type Chain struct {
        Hdr           RR_Header
        Version       uint8
        InitialKeyTag uint16
        StartingZone  uint8
        NumZones      uint8
        Zones         []Zone
}
</pre><a href="#section-3.1-9" class="pilcrow">¶</a>
</div>
<p id="section-3.1-10">The <code>Version</code> field of <code>Chain</code> <span class="bcp14">MUST</span> contain the version number of this DNSSEC serialization protocol. This draft describes version 1. The <code>InitialKeyTag</code> field <span class="bcp14">MUST</span> contain a short digest of the trust anchor's key signing key (KSK) or be set to zero to use the IANA root. The integer <code>StartingZone</code> indicates the starting level in the DNS hierarchy for the response data. A <code>KeyIndex</code> value being set to 0, means the entire proof chain all the way to the root (.) is included.<a href="#section-3.1-10" class="pilcrow">¶</a></p>
<p id="section-3.1-11">The resolution of the <code>AAAA</code> records for the FQDN <code>example.com.</code>, results in a response with three <code>Zone</code>s:<a href="#section-3.1-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-12">
<pre>
Zone[0]:
    - Hdr
    - Name (example.com.)
    - PreviousName (NONE)
    - ZSKIndex
    - NumKeys (1)
    - Keys
        - DNSKEY (example.com.)
    - NumKeySigs (1)
    - KeySigs
        - Signature (example.com.)
    - NumDS (1)
    - DSSet
        - DS (com.)
    - NumDSSigs (1)
    - DSSigs
        - Signature (com.)
    - NumLeaves (1)
    - Leaves
        - RR (AAAA)
    - NumLeavesSigs (1)
    - LeavesSigs
        - Signature (AAAA)
Zone[1]:
    - Hdr
    - Name (com.)
    - PreviousName (example.com.)
    - ZSKIndex
    - NumKeys (1)
    - Keys
        - DNSKEY (com.)
    - NumKeySigs (1)
    - KeySigs
        - Signature (com.)
    - NumDS (1)
    - DSSet
        - DS (.)
    - NumDSSigs (1)
    - DSSigs
        - Signature (.)
Zone[2]:
    - Hdr
    - Name (.)
    - PreviousName (com.)
    - ZSKIndex
    - NumKeys (1)
    - Keys
        - DNSKEY (.)
    - NumKeySigs (1)
    - KeySigs
        - Signature (.)
    - NumDS (1)
    - DSSet
        - DS (.)
    - NumDSSigs (1)
    - DSSigs
        - Signature (.)
</pre><a href="#section-3.1-12" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="client">
<section id="section-3.2">
        <h3 id="name-client">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-client" class="section-name selfRef">Client</a>
        </h3>
<p id="section-3.2-1">Clients <span class="bcp14">MAY</span> communicate with a validating recursive resolver using the protocol of their choice and <span class="bcp14">MUST</span> set both the DO
and SP bits in the DNS query sent to the recursive resolver. The resolver performs the required resolutions, serializes
the proof and returns the serialized proof as a resource record in the ADDITIONAL section of the response as well as
the answer associated with the query in the ANSWER section.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The client uses the OPT RR <span>[<a href="#EDNS0" class="cite xref">EDNS0</a>]</span> and uses flag <code>SP</code>. Both <code>DO</code> and <code>SP</code> bits <span class="bcp14">MUST</span> be true, and the
remaining flags Z set to zero by the client. They <span class="bcp14">SHOULD</span> be ignored by the receiving resolver.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-3">
<pre>
            +0 (MSB)                            +1 (LSB)
   +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
0: |         EXTENDED-RCODE        |            VERSION            |
   +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
2: | DO| SP|                       Z                               |
   +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
</pre><a href="#section-3.2-3" class="pilcrow">¶</a>
</div>
<p id="section-3.2-4">The usage of the <code>SP</code> comes with an <span class="bcp14">OPTIONAL</span> usage of a <code>SKIP RR</code> included in the additional section of the DNS Message
to the resolver by the client. SKIP RR Type contains a <code>uint8</code> indicating the KeyIndex from the root to skip:<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-5">
<pre>
struct {
    struct {
        string Name;
        uint8  Rrtype;
        uint32 Ttl;
        uint16 Rdlength;
    } RR_Header;
    uint8 KeyIndex;
} SKIP;
</pre><a href="#section-3.2-5" class="pilcrow">¶</a>
</div>
<p id="section-3.2-6">The value of <code>InitialKeyIndex</code> starting at <code>0</code> indicates that no levels of the proof chain are skipped by the resolver when
the serialized response is returned to the client. Alternatively, providing a digest of the trust anchor's key signing key (KSK) indicates where the client can stop validating as it traverses the DNS hierarchy. This is an <span class="bcp14">OPTIONAL</span> optimization a client could use to
provide hints to the resolver in an attempt to reduce the size of the serialized DNS message on the wire. The records
skipped would be the <code>Zone</code> structures for all zones beyond the purview of the provided trust anchor.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<p id="section-3.2-7">The client COULD leverage this optimization when a cache containing the validated DNSKEYs, DS records are cached
preventing repeated transmission of the response data or cryptographic verifications.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<div id="resolver-verification">
<section id="section-3.2.1">
          <h4 id="name-resolver-verification">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-resolver-verification" class="section-name selfRef">Resolver Verification</a>
          </h4>
<p id="section-3.2.1-1">Similar to DNSSEC, a validating recursive resolver <span class="bcp14">MUST</span> individually validate the signed responses obtained from the
various name servers during query resolution. All responses <span class="bcp14">MUST</span> be cryptographically valid for the serialization to be
constructed. In case of failure, the server indicates a failed resolution with the appropriate SERVFAIL response code
and return the invalid serialization to the client if the CD bit is set, in addition to the SP and DO bits.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">If the query to the resolver contains the <code>SP</code> bit set in the OPT RR, it <span class="bcp14">MUST</span> check for the existence of the <code>SKIP</code>
records in the additional section of the message. The SKIP result is included in the response returned to the client
and the chain is updated accordingly.<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-verification">
<section id="section-3.2.2">
          <h4 id="name-client-verification">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-client-verification" class="section-name selfRef">Client Verification</a>
          </h4>
<p id="section-3.2.2-1">The clients obtaining the serialized responses pop <code>Zone</code>s off the . The client executes the following algorithm:<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.2-2">
<pre>
BEGIN Verification(query, chain, starting_zone):
  UpdateChain(query, &amp;chain, starting_zone)
  for index, zone in chain.Zones:
    key_validity = Verify(zone.Keys,
                          zone.KeySigs,
                          getKSK(zone.Keys))
    assertTrue(key_validity)

    if length(zone.Leaves) == 0:
      ds_sig_validity = Verify(zone.DSSet,
                               zone.DSSigs,
                               getZSKs(zone.Keys))
      ds_hash_validity = HashCompareEqual(zone.DSSet,
                                          ToDS(
                                            getKSK(
                                              chain.Zones[index+1].Keys
                                            )
                                          )
                                         )
      assertTrue(ds_sig_validity &amp;&amp; ds_hash_validity)
    else:
      leaves_sig_validity = Verify(zone.Leaves,
                                   zone.LeavesSigs,
                                   getZSKs(zone.Keys))
      assertTrue(leaves_sig_validity)
  return True
END
</pre><a href="#section-3.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2.2-3">The <code>UpdateChain</code> method updates the returned serialized Chain response and includes information about the DNSKEY, DS
resource records from the validated cache by reconstructing the chain which is then validated. The <code>Verify()</code> method
takes as arguments the DNS RRs, the signature RRSIG, and a DNSKEY returning a boolean. Similarly <code>HashCompareEqual</code> takes as input two DS
records and compares them returning a boolean.<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2.2-4">Note that it is possible to perform cryptographic validations of partial chains without updating the chain explicitly
to include skipped records if the records are already present in a trusted cache. To successfully confirm the validation
to the root trust anchors, the DNSKEYs from the cache at the domain hierarchy level are necessary to validate the
signatures associated with the Leaving section of the first element in the chain. In the example presented above:<a href="#section-3.2.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.2-5">
<pre>
COM_DNSKEY = getZsk(LookupCache(.com., DNSKEY))
Verify(chain.Zones[0].DSSet, chain.Zones[0].DSSigs, COM_DNSKEY)
</pre><a href="#section-3.2.2-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="resolver-cache-considerations">
<section id="section-3.3">
        <h3 id="name-resolver-cache-consideratio">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-resolver-cache-consideratio" class="section-name selfRef">Resolver Cache Considerations</a>
        </h3>
<p id="section-3.3-1">Validating resolvers continue to maintain their caches as is current practice.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="modifications-to-existing-rfcs">
<section id="section-3.4">
        <h3 id="name-modifications-to-existing-r">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-modifications-to-existing-r" class="section-name selfRef">Modifications to Existing RFCs</a>
        </h3>
<p id="section-3.4-1">TODO: Need help with this one. I've referenced a few RFCs with this draft so far which might be extended.
It looks like we are introducing new RRType and bits for which specific numbers need to be granted.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-4-1">Many public recursive resolvers today used by clients validate DNSSEC responses and protect their clients by
returning a DNS Error Code (RCODE) in the response. However, responses to queries with the client DO bit set
result in a partial response of the intended resource records and its corresponding signature. As a result,
clients using a validating recursive resolver delegate their trust to the resolver. A client stub with the
validation capabilities should be able to verify the correctness of the responses further reducing the amount
of implicit trust placed in the resolver.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Responses sent for the DNS queries include larger responses due to the existence of the serialized proof chain
potentially resulting in DDoS attacks. Existing practices to prevent DDoS attacks for larger DNSSEC responses
could continue to be considered and improved.<a href="#section-4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="performance-considerations">
<section id="section-5">
      <h2 id="name-performance-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-performance-considerations" class="section-name selfRef">Performance Considerations</a>
      </h2>
<p id="section-5-1">The serialization of the necessary RRs and their RRSIGs by the recursive resolver does not
adversely impact resolution latency (network). The cryptographic computational overheads to verify the serialized
responses and the accompanying answer is minimal. This section provides indicational performance using an
implementation of the proposal in Go. This implementation includes the entire proof chain with no optimizations for the queries.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="size-overheads">
<section id="section-5.1">
        <h3 id="name-size-overheads">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-size-overheads" class="section-name selfRef">Size Overheads</a>
        </h3>
<p id="section-5.1-1">The following measurements are performed for 10000 queries requesting the A records from the recursive resolver. The median size of the
response is 2172 Bytes indicating a 247% increase in size compared to the client recursively performing all the queries
required to validate the DNSSEC responses. For various protocols, the sizes are the following:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-2">
<pre>
| Protocol | Median N/W RX | Percent Increase |
|----------|---------------|------------------|
| Do53 UDP | 2172 Bytes    | 247.5%           |
| Do53 TCP | 2178 Bytes    | 248.5%           |
| DoH      | 2180 Bytes    | 248.8%           |
</pre><a href="#section-5.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="measured-latency-overheads">
<section id="section-5.2">
        <h3 id="name-measured-latency-overheads">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-measured-latency-overheads" class="section-name selfRef">Measured Latency Overheads</a>
        </h3>
<p id="section-5.2-1">The median response times for the queries including the proof compared to the Leaf only responses from a validating
recursive resolver are as follows:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-2">
<pre>
| Protocol | Median Latency (ms) | Percent Increase |
|----------|---------------------|------------------|
| Do53 UDP | 172.54              | 0.15%            |
| Do53 TCP | 192.29              | 0.45%            |
| DoH      | 173.44              | 1.10%            |
</pre><a href="#section-5.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">Register SP field, SKIP resource record<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-normative-references">
<section id="section-7">
      <h2 id="name-normative-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="DNSSEC">[DNSSEC]</dt>
      <dd>
<span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Austein, R.</span>, <span class="refAuthor">Larson, M.</span>, <span class="refAuthor">Massey, D.</span>, and <span class="refAuthor">S. Rose</span>, <span class="refTitle">"Resource Records for the DNS Security Extensions"</span>, <span class="seriesInfo">RFC 4034</span>, <span class="seriesInfo">DOI 10.17487/RFC4034</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4034">https://www.rfc-editor.org/rfc/rfc4034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EDNS0">[EDNS0]</dt>
      <dd>
<span class="refAuthor">Damas, J.</span>, <span class="refAuthor">Graff, M.</span>, and <span class="refAuthor">P. Vixie</span>, <span class="refTitle">"Extension Mechanisms for DNS (EDNS(0))"</span>, <span class="seriesInfo">STD 75</span>, <span class="seriesInfo">RFC 6891</span>, <span class="seriesInfo">DOI 10.17487/RFC6891</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6891">https://www.rfc-editor.org/rfc/rfc6891</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RDATA">[RDATA]</dt>
      <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1035">https://www.rfc-editor.org/rfc/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1034">[RFC1034]</dt>
      <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - concepts and facilities"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1034</span>, <span class="seriesInfo">DOI 10.17487/RFC1034</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1034">https://www.rfc-editor.org/rfc/rfc1034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9102">[RFC9102]</dt>
      <dd>
<span class="refAuthor">Dukhovni, V.</span>, <span class="refAuthor">Huque, S.</span>, <span class="refAuthor">Toorop, W.</span>, <span class="refAuthor">Wouters, P.</span>, and <span class="refAuthor">M. Shore</span>, <span class="refTitle">"TLS DNSSEC Chain Extension"</span>, <span class="seriesInfo">RFC 9102</span>, <span class="seriesInfo">DOI 10.17487/RFC9102</span>, <time datetime="2021-08" class="refDate">August 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9102">https://www.rfc-editor.org/rfc/rfc9102</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SERIALIZECHAIN">[SERIALIZECHAIN]</dt>
    <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refTitle">"Serializing DNS Records with DNSSEC Authentication"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-agl-dane-serializechain-01</span>, <time datetime="2011-07-01" class="refDate">1 July 2011</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-agl-dane-serializechain-01">https://datatracker.ietf.org/doc/html/draft-agl-dane-serializechain-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">TODO acknowledge.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2"><span>[<a href="#RFC9102" class="cite xref">RFC9102</a>]</span>
        <span>[<a href="#SERIALIZECHAIN" class="cite xref">SERIALIZECHAIN</a>]</span><a href="#appendix-A-2" class="pilcrow">¶</a></p>
<div id="test-vectors">
<section id="appendix-A.1">
        <h3 id="name-test-vectors">
<a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h3>
</section>
</div>
</section>
</div>
<div id="appendix">
<section id="appendix-B">
      <h2 id="name-appendix">
<a href="#name-appendix" class="section-name selfRef">Appendix</a>
      </h2>
<div id="test-vectors-1">
<section id="appendix-B.1">
        <h3 id="name-test-vectors-2">
<a href="#name-test-vectors-2" class="section-name selfRef">Test vectors</a>
        </h3>
<p id="appendix-B.1-1">TODO<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Sudheesh Singanamalla</span></div>
<div dir="auto" class="left"><span class="org">University of Washington</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:sudheesh@cs.washington.edu" class="email">sudheesh@cs.washington.edu</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ben Weintraub</span></div>
<div dir="auto" class="left"><span class="org">Northeastern University</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:weintraub.b@northeastern.edu" class="email">weintraub.b@northeastern.edu</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Thibault Meunier</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mail@thibaultmeunier.com" class="email">mail@thibaultmeunier.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
